<!doctype html>
<html>
<head>
  <script type="text/javascript" src="mocha.js"></script>
  <script type="text/javascript" src="chai.js"></script>
  <link rel="stylesheet" href="mocha.css">
</head>
<body>
  <div id="mocha"></div>
  <script>mocha.setup('bdd')</script>
  <script src="mocha-asynculous.js"></script>
  <script>
  describe('Something', function() {
    it('should work with single setTimeout', function() {
      setTimeout(function() {
        throw new Error('expected');
      }, 50);
    });

    it('should work with setInterval', function() {
      var counter = 0;
      setInterval(function() {
        counter++;
        if (counter == 4) {
          throw new Error('expected');
        }
      }, 50);
    });

    it('should work with double setTimeout', function() {
      setTimeout(function() {
        chai.expect(1).to.equal(1);
        setTimeout(function() {
          throw new Error('expected');
        }, 140);
      }, 50);
    });

    it('should work with clearTimeout', function() {
      setTimeout(function() {
        chai.expect(1).to.equal(1);
        var timer = setTimeout(function() {
          throw new Error('unexpected');
        }, 140);
        clearTimeout(timer);
        throw new Error('expected');
      }, 50);
    });

    it('should work with requestAnimationFrame', function() {
      requestAnimationFrame(function() {
        throw new Error('expected');
      });
    });

    it('should work in sync mode', function() {
      throw new Error('expected');
    });
  });  
  </script>
  <script>
  mocha.run();
  </script>
</body>
</html>
